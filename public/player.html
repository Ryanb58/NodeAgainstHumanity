<!doctype html>
<html>
<head>
    <title>Player - Node Against Humanity</title>
    <link rel="StyleSheet" href="style.css" type="text/css" media="screen">
</head>
<body>
    <div id="joinGamePage">
        <form action="">
            Game Code<input id="code" />
            First Name<input id="username" />
            <button>Join Game</button>
        </form>
    </div>
    <div id="handPage">
        <strong>Cards:</strong>
        <ul id="myHand"><li><strong><a href="je">Yep</a></strong></li></ul>
    </div>
    <div id="gameMasterPage">
        <h2>You are the game master!</h2>
        <h3></h3>
    </div>

<script src="/socket.io/socket.io.js"></script>
<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
<script>
var socket = io();
var gameId = undefined;
var username = "";

$(document).ready(function() {
    // User Interactions
    $('form').submit(function(){
        var code = $('#code').val();
        var name = $('#username').val();
        console.log(code + " " + name);
        socket.emit('add:playerToGame',code ,name);
        gameId = code;
        username = name;
        return false;
    });
});

//User selects a card to send.
//Manipulate things that have already been manipulated on the DOM.
$(document).on("click","#handPage #myHand li strong a", function(event){
    event.preventDefault();
    //Get the original URL.. which is actually the cards index in the array.

    var cardIndex = $(this).attr('href');

    console.log("Card " + cardIndex + " clicked!");
    //" + $(this).attr('href') + "

    socket.emit('submit:card', gameId, username, cardIndex);
});

//Link socket actions to functions.
socket.on('list:hand', updateCardsInHand);
//FUnctions
function updateCardsInHand(cards)
{
    //Empty the current cards.
    $('#myHand').empty();

    for(i=0;i<cards.length;i++)
    {
        $('#myHand').append('<li><strong><a href="'+ i +'">' + cards[i].text + '</a></strong></li>');
    }
/*
    $.each(cards, function(){
        $('#myHand').append('<li><strong>' + this.text + '</strong></li>');
    })
*/
}

</script>
  </body>
</html>
